<!DOCTYPE html>
<html lang="en">

<head>
     
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#2A80EE">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#2A80EE">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#2A80EE">
<title>Optical Character Reader Using Angular And Azure Computer Vision &#8211; Girish Godage</title>
<meta name="description" content="In this article, we will create an optical character recognition (OCR) application using Angular and the Azure Computer Vision Cognitive Service.">
<meta name="keywords" content="AzureAI">

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all">

<!-- Verifications -->
    
    
        
<!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Optical Character Reader Using Angular And Azure Computer Vision">
    <meta property="og:description" content="I am a passionate Leader, who has a good command in technology &amp; Mangement. Also, I am a creative designer and an innovatie techie.">
    <meta property="og:url" content="http://localhost:4000/blog/ocr-using-angular-AzureComputerVision">
    <meta property="og:site_name" content="Girish Godage">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@GGodage" />
    
    <meta name="twitter:title" content="Optical Character Reader Using Angular And Azure Computer Vision" />
    <meta name="twitter:description" content="In this article, we will create an optical character recognition (OCR) application using Angular and the Azure Computer Vision Cognitive Service." />
    <meta name="twitter:url" content="http://localhost:4000/blog/ocr-using-angular-AzureComputerVision" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/img/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/img/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
    


    <link rel="canonical" href="http://localhost:4000/blog/ocr-using-angular-AzureComputerVision">
<link rel="alternate" type="application/rss+xml" title="RSS Feed for Girish Godage" href="/feed.xml" />
    <!-- Bootstrap CSS-->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <!-- Google fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Advent+Pro">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Varela+Round">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abel">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
   
    <!-- owl carousel-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.css" >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.theme.css">
    
    <!-- animate.css-->
    <link rel="stylesheet" href="http://localhost:4000/sitejs/animate.css/animate.css">
    <!-- theme stylesheet-->
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="http://localhost:4000/css/custom.css" as="style">
    <link rel="stylesheet" href="http://localhost:4000/css/comments.css" as="style">
    <!-- Favicon-->
    <link rel="shortcut icon" href="http://localhost:4000/img/logo-big.png">
    <!-- Fab Icon-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-mfizz/2.4.1/font-mfizz.min.css">
    
    

    <!-- Global site tag (gtag.js) - Google Analytics -->
    
    <script type="text/javascript">
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
       ga('create', 'UA-130164763-2', 'auto');
       ga('send', 'pageview');
    </script>
    
    <!-- Typed.js DONT TOUCHHHHHHHHHHHHH!-->
    <!--<script src="https://cdn.rawgit.com/mattboldt/typed.js/master/lib/typed.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.9/typed.min.js"></script>
    <script>
        function copyToClipboard(element) {
            var $temp = $("<input>");
            $("body").append($temp);
            $temp.val($(element).text()).select();
            document.execCommand("copy");
            $temp.remove();
        }
      </script>
      
      <!-- START OF RELEVANT PART -->
    <script async src="https://just-comments.com/w2.js"></script>
    <!-- END OF RELEVANT PART -->


</head>

<body>
    
<!-- navbar-->
<header class="header">
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container"><a class="navbar-brand" href="http://localhost:4000"><img
          src="http://localhost:4000/img/logo-big.png" width="50" height="50" class="d-inline-block align-center"
          alt="logo"> <img src="http://localhost:4000/img/girish_logo.png" height="30" alt="girilogo"></a>
      <button type="button" data-toggle="collapse" data-target="#navbarcollapse" aria-controls="navbarSupportedContent"
        aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler navbar-toggler-right"><span
          class="fa fa-bars" style="color: white"></span></button>
      <div id="navbarcollapse" class="collapse navbar-collapse">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item"><a href="http://localhost:4000#home" class="nav-link  link-scroll">Home</a></li>
          <li class="nav-item"><a href="http://localhost:4000#about" class="nav-link link-scroll">About</a></li>
          <li class="nav-item"><a href="http://localhost:4000#skills" class="nav-link link-scroll">Skills</a>
          </li>
          <li class="nav-item"><a href="http://localhost:4000#services" class="nav-link link-scroll">Services</a>
          </li>
          <li class="nav-item"><a href="http://localhost:4000#references" class="nav-link link-scroll">My
              work</a></li>
          <li class="nav-item"><a href="http://localhost:4000#contact" class="nav-link link-scroll">Contact</a>
          </li>
          <li class="nav-item"><a href="http://localhost:4000/blog" class="nav-link link-scroll">Blog</a></li>
        </ul>
      </div>
    </div>
  </nav>
</header>

    
    
    
    <div style="background-color:Gray;">
        <div style="padding:0;min-height:95.05vh;display:flex;font-family: Poppins, sans-serif;margin-top: 5rem;"
            class="container">
            <div class="col-lg-12 col-md-12 col-sm-12">
                <p class="post-title">
                    <h1><a href="/blog/ocr-using-angular-AzureComputerVision">Optical Character Reader Using Angular And Azure Computer Vision</a></h1>
                </p>
                
                <span class="post-meta">
              <span style="font-weight:600">December 17, 2020 Thursday</span>
                    
                       ( 15 minute read ) 
                    
                     
                    <a style="font-weight:600" href="https://twitter.com/girishgodage_007" target="_blank">   by Girish Godage</a>
                </span>
                
                <div class="site-category"> 
                        <h5>AzureAI</h5>
                </div>
                
                <hr>
                <div><img class="post-image" src="/img/azure/9/output.gif" alt="Optical Character Reader Using Angular And Azure Computer Vision" height="250" /></div>
                <div class="post-content">
                    <br>                     
                    <h2 id="introduction">Introduction</h2>

<p>In this article, we will create an optical character recognition (OCR) application using Angular and the Azure Computer Vision Cognitive Service. Computer Vision is an AI service that analyzes content in images. We will use the OCR feature of Computer Vision to detect the printed text in an image. The application will extract the text from the image and detects the language of the text. Currently, the OCR API supports 25 languages.</p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>Install the latest LTS version of Node.JS from https://nodejs.org/en/download/</li>
  <li>Install the Angular CLI from https://cli.angular.io/</li>
  <li>An Azure subscription account. You can create a free  Azure account at https://azure.microsoft.com/en-in/free/</li>
  <li>Install the .NET Core 3.1 SDK from https://dotnet.microsoft.com/download/dotnet-core/3.1</li>
  <li>Install the latest version of Visual Studio 2019 from https://visualstudio.microsoft.com/downloads/</li>
</ul>

<blockquote>
  <p>We will use an <span style="color:yellow;background-color:black;">ASP.NET Core backend </span> for this application. The <span style="color:yellow;background-color:black;"> ASP.NET Core backend </span> provides a straight forward authentication process to access Azure cognitive services. This will also ensure that the end-user won’t have direct access to cognitive services.</p>
</blockquote>

<h2 id="create-the-azure-computer-vision-cognitive-service-resource">Create the Azure Computer Vision Cognitive Service resource</h2>

<p>Log in to the Azure portal and search for the cognitive services in the search bar and click on the result. Refer to the image shown below.</p>

<p><img src="/img/azure/9/SearchCognitive.png" alt="image info" /></p>

<p>On the next screen, click on the Add button. It will open the cognitive services marketplace page. Search for the Computer Vision in the search bar and click on the search result. It will open the Computer Vision API page. Click on the Create button to create a new Computer Vision resource. Refer to the image shown below.</p>

<p><img src="/img/azure/9/CreateComputerVision.png" alt="image info" /></p>

<p>On the Create page, fill in the details as indicated below.</p>

<ul>
  <li><strong>Name</strong>: Give a unique name for your resource.</li>
  <li><strong>Subscription</strong>: Select the subscription type from the dropdown.</li>
  <li><strong>Pricing tier</strong>: Select the pricing tier as per your choice.</li>
  <li><strong>Resource group</strong>: Select an existing resource group or create a new one.</li>
</ul>

<p>Click on the Create button. Refer to the image shown below.</p>

<p><img src="/img/azure/9/CreateComputerVision_1.png" alt="image info" /></p>

<p><img src="/img/azure/9/CreateComputerVision_2.png" alt="image info" /></p>

<p>After your resource is successfully deployed, click on the “Go to resource” button. You can see the Key and the endpoint for the newly created Computer Vision resource. Refer to the image shown below.</p>

<p><img src="/img/azure/9/ComputerVisionKeyNEndPoint.png" alt="image info" /></p>

<p>Make a note of the <strong>key and the endpoint</strong>. We will be using these in the latter part of this article to invoke the Computer Vision OCR API from the .NET Code. The values are masked here for privacy.</p>

<h2 id="creating-the-aspnet-core-application">Creating the ASP.NET Core application</h2>

<p>Open Visual Studio 2019 and click on “Create a new Project”. A “Create a new Project” dialog will open. Select “ASP.NET Core Web Application” and click on Next. Now you will be at “Configure your new project” screen, provide the name for your application as ngComputerVision and click on create. Refer to the image shown below.</p>

<p><img src="/img/azure/9/Configure_CoreWebApp.png" alt="image info" /></p>

<p>You will be navigated to “Create a new ASP.NET Core web application” screen. Select “.NET Core” and “ASP.NET Core 3.1” from the dropdowns on the top. Then, select the “Angular” project template and click on Create. Refer to the image shown below.</p>

<p><img src="/img/azure/9/Create_CoreWebApp.png" alt="image info" /></p>

<p>This will create our project. The folder structure of the application is shown below.</p>

<p><img src="/img/azure/9/SolutionFolderStructure.png" alt="image info" /></p>

<p>The <span style="color:yellow;background-color:black;">ClientApp </span> folder contains the Angular code for our application. The Controllers folders will contain our API controllers. The angular components are present inside the <span style="color:yellow;background-color:black;">ClientApp\src\app </span> folder. The default template contains few Angular components. These components won’t affect our application, but for the sake of simplicity, we will delete fetchdata and counter folders from <span style="color:yellow;background-color:black;">ClientApp/app/components</span> folder. Also, remove the reference for these two components from the <span style="color:yellow;background-color:black;">app.module.ts</span> file.</p>

<h2 id="installing-computer-vision-api-library">Installing Computer Vision API library</h2>
<p>We will install the Azure Computer Vision API library which will provide us with the models out of the box to handle the Computer Vision REST API response. To install the package, navigate to Tools » NuGet Package Manager » Package Manager Console. It will open the Package Manager Console. Run the command as shown below.</p>

<pre><code class="language-code">  Install-Package Microsoft.Azure.CognitiveServices.Vision.ComputerVision -Version 5.0.0

</code></pre>
<p>You can learn more about this package at the <a href="https://www.nuget.org/packages/Microsoft.Azure.CognitiveServices.Vision.ComputerVision/">NuGet gallery</a>.</p>

<h2 id="create-the-models">Create the Models</h2>

<p>Right-click on the <span style="color:yellow;background-color:black;">ngComputerVision</span> project and select Add » New Folder. Name the folder as Models. Again, right-click on the Models folder and select Add » Class to add a new class file. Put the name of your class as <span style="color:yellow;background-color:black;">LanguageDetails.cs</span> and click Add.</p>

<p>Open <span style="color:yellow;background-color:black;">LanguageDetails.cs</span> and put the following code inside it.</p>

<pre><code class="language-code">  namespace ngComputerVision.Models
{
    public class LanguageDetails
    {
        public string Name { get; set; }
        public string NativeName { get; set; }
        public string Dir { get; set; }
    }
}

</code></pre>

<p>Similarly, add a new class file <span style="color:yellow;background-color:black;">AvailableLanguage.cs </span> and put the following code inside it.</p>

<pre><code class="language-code">  using System.Collections.Generic;
  namespace ngComputerVision.Models
  {
      public class AvailableLanguage
      {
          public Dictionary&lt;string, LanguageDetails&gt; Translation { get; set; }
      }
  }

</code></pre>
<p>We will also add two classes as DTO (Data Transfer Object) for sending data back to the client.</p>

<p>Create a new folder and name it <span style="color:yellow;background-color:black;">DTOModels</span>. Add the new class file <span style="color:yellow;background-color:black;">AvailableLanguageDTO.cs</span> in the <span style="color:yellow;background-color:black;">DTOModels</span> folder and put the following code inside it.</p>

<pre><code class="language-code">
  namespace ngComputerVision.DTOModels
  {
      public class AvailableLanguageDTO
      {
          public string LanguageID { get; set; }
          public string LanguageName { get; set; }
      }
  }

</code></pre>

<p>Add the <span style="color:yellow;background-color:black;">OcrResultDTO.cs</span> file and put the following code inside it.</p>

<pre><code class="language-code">  namespace ngComputerVision.DTOModels
  {
      public class OcrResultDTO
      {
          public string Language { get; set; }
          public string DetectedText { get; set; }
      }
  }

</code></pre>
<h2 id="adding-the-ocr-controller">Adding the OCR Controller</h2>

<p>We will add a new controller to our application. Right-click on the Controllers folder and select Add » New Item. An “Add New Item” dialog box will open. Select “Visual C#” from the left panel, then select “API Controller Class” from templates panel and put the name as <span style="color:yellow;background-color:black;">OCRController.cs</span>. Click on Add. Refer to the image below.</p>

<p><img src="/img/azure/9/AddAPIController.png" alt="image info" /></p>

<p>The OCRController will handle the image recognition requests from the client app. This controller will also return the list of all the languages supported by OCR API.</p>

<p>Open the <span style="color:yellow;background-color:black;">OCRController.cs</span> file and put the following code inside it.</p>

<pre><code class="language-code">  using System;
  using System.Threading.Tasks;
  using Microsoft.AspNetCore.Mvc;
  using System.Net.Http;
  using System.Net.Http.Headers;
  using Newtonsoft.Json.Linq;
  using System.IO;
  using Newtonsoft.Json;
  using System.Text;
  using ngComputerVision.Models;
  using System.Collections.Generic;
  using Microsoft.Azure.CognitiveServices.Vision.ComputerVision.Models;
  using ngComputerVision.DTOModels;
  namespace ngComputerVision.Controllers
  {
      [Produces("application/json")]
      [Route("api/[controller]")]
      public class OCRController : Controller
      {
          static string subscriptionKey;
          static string endpoint;
          static string uriBase;
          public OCRController()
          {
              subscriptionKey = "fc791774e60e455da79546c50e1ca504";
              endpoint = "https://ngocrdemo.cognitiveservices.azure.com/";
              uriBase = endpoint + "vision/v2.1/ocr";
          }
          [HttpPost, DisableRequestSizeLimit]
          public async Task&lt;OcrResultDTO&gt; Post()
          {
              StringBuilder sb = new StringBuilder();
              OcrResultDTO ocrResultDTO = new OcrResultDTO();
              try
              {
                  if (Request.Form.Files.Count &gt; 0)
                  {
                      var file = Request.Form.Files[Request.Form.Files.Count - 1];
                      if (file.Length &gt; 0)
                      {
                          var memoryStream = new MemoryStream();
                          file.CopyTo(memoryStream);
                          byte[] imageFileBytes = memoryStream.ToArray();
                          memoryStream.Flush();
                          string JSONResult = await ReadTextFromStream(imageFileBytes);
                          OcrResult ocrResult = JsonConvert.DeserializeObject&lt;OcrResult&gt;(JSONResult);
                          if (!ocrResult.Language.Equals("unk"))
                          {
                              foreach (OcrLine ocrLine in ocrResult.Regions[0].Lines)
                              {
                                  foreach (OcrWord ocrWord in ocrLine.Words)
                                  {
                                      sb.Append(ocrWord.Text);
                                      sb.Append(' ');
                                  }
                                  sb.AppendLine();
                              }
                          }
                          else
                          {
                              sb.Append("This language is not supported.");
                          }
                          ocrResultDTO.DetectedText = sb.ToString();
                          ocrResultDTO.Language = ocrResult.Language;
                      }
                  }
                  return ocrResultDTO;
              }
              catch
              {
                  ocrResultDTO.DetectedText = "Error occurred. Try again";
                  ocrResultDTO.Language = "unk";
                  return ocrResultDTO;
              }
          }
          static async Task&lt;string&gt; ReadTextFromStream(byte[] byteData)
          {
              try
              {
                  HttpClient client = new HttpClient();
                  client.DefaultRequestHeaders.Add("Ocp-Apim-Subscription-Key", subscriptionKey);
                  string requestParameters = "language=unk&amp;detectOrientation=true";
                  string uri = uriBase + "?" + requestParameters;
                  HttpResponseMessage response;
                  using (ByteArrayContent content = new ByteArrayContent(byteData))
                  {
                      content.Headers.ContentType = new MediaTypeHeaderValue("application/octet-stream");
                      response = await client.PostAsync(uri, content);
                  }
                  string contentString = await response.Content.ReadAsStringAsync();
                  string result = JToken.Parse(contentString).ToString();
                  return result;
              }
              catch (Exception e)
              {
                  return e.Message;
              }
          }
          [HttpGet]
          public async Task&lt;List&lt;AvailableLanguageDTO&gt;&gt; GetAvailableLanguages()
          {
              string endpoint = "https://api.cognitive.microsofttranslator.com/languages?api-version=3.0&amp;scope=translation";
              var client = new HttpClient();
              using (var request = new HttpRequestMessage())
              {
                  request.Method = HttpMethod.Get;
                  request.RequestUri = new Uri(endpoint);
                  var response = await client.SendAsync(request).ConfigureAwait(false);
                  string result = await response.Content.ReadAsStringAsync();
                  AvailableLanguage deserializedOutput = JsonConvert.DeserializeObject&lt;AvailableLanguage&gt;(result);
                  List&lt;AvailableLanguageDTO&gt; availableLanguage = new List&lt;AvailableLanguageDTO&gt;();
                  foreach (KeyValuePair&lt;string, LanguageDetails&gt; translation in deserializedOutput.Translation)
                  {
                      AvailableLanguageDTO language = new AvailableLanguageDTO();
                      language.LanguageID = translation.Key;
                      language.LanguageName = translation.Value.Name;
                      availableLanguage.Add(language);
                  }
                  return availableLanguage;
              }
          }
      }
  } 

</code></pre>

<p>In the constructor of the class, we have initialized the key and the endpoint URL for the OCR API.</p>

<p>The Post method will receive the image data as a file collection in the request body and return an object of type <span style="color:yellow;background-color:black;">OcrResultDTO</span>. We will convert the image data to a byte array and invoke the <span style="color:yellow;background-color:black;">ReadTextFromStream</span> method. We will deserialize the response into an object of type <span style="color:yellow;background-color:black;">OcrResult</span>. We will then form the sentence by iterating over the <span style="color:yellow;background-color:black;">OcrWord</span> object.</p>

<p>Inside the <span style="color:yellow;background-color:black;">ReadTextFromStream</span> method, we will create a new <span style="color:yellow;background-color:black;">HttpRequestMessage</span>. This HTTP request is a Post request. We will pass the subscription key in the header of the request. The OCR API will return a JSON object having each word from the image as well as the detected language of the text.</p>

<p>The <span style="color:yellow;background-color:black;">GetAvailableLanguages</span> method will return the list of all the language supported by the Translate Text API. We will set the request URI and create a <span style="color:yellow;background-color:black;">HttpRequestMessage</span> which will be a Get request. This request URI will return a JSON object which will be deserialized to an object of type <span style="color:yellow;background-color:black;">AvailableLanguage</span>.</p>

<h2 id="why-do-we-need-to-fetch-the-list-of-supported-languages">Why do we need to fetch the list of supported languages?</h2>

<p>The OCR API returns the language code (e.g. en for English, de for German, etc.) of the detected language. But we cannot display the language code on the UI as it is not user-friendly. Therefore, we need a dictionary to look up the language name corresponding to the language code.</p>

<p>The Azure Computer Vision OCR API supports 25 languages. To know all the languages supported by OCR API see the list of <a href="https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/language-support">supported languages</a>. These languages are a subset of the languages supported by the Azure Translate Text API. Since there is no dedicated API endpoint to fetch the list of languages supported by OCR API, therefore, we are using the Translate Text API endpoint to fetch the list of languages. We will create the language lookup dictionary using the JSON response from this API call and filter the result based on the language code returned by the OCR API.</p>

<h2 id="working-on-the-client-side-of-the-application">Working on the Client side of the application</h2>

<p>The code for the client-side is available in the <span style="color:yellow;background-color:black;">ClientApp</span> folder. We will use Angular CLI to work with the client code.</p>

<blockquote>
  <p>Using Angular CLI is not mandatory. I am using Angular CLI here as it is user-friendly and easy to use. If you don’t want to use CLI then you can create the files for components and services manually.</p>
</blockquote>

<p>Navigate to the <span style="color:yellow;background-color:black;">ngComputerVision\ClientApp </span> folder in your machine and open a command window. We will execute all our Angular CLI commands in this window.</p>

<h2 id="create-the-models-1">Create the models</h2>

<p>Create a folder called <span style="color:yellow;background-color:black;">models</span> inside the <span style="color:yellow;background-color:black;">ClientApp\src\app</span> folder. Now we will create a file <span style="color:yellow;background-color:black;">availablelanguage.ts</span> in the models folder. Put the following code in it.</p>

<pre><code class="language-code">  export class AvailableLanguage {
    languageID: string;
    languageName: string;
  }

</code></pre>

<p>Similarly, create another file inside the models folder called <span style="color:yellow;background-color:black;">ocrresult.ts</span>. Put the following code in it.</p>

<pre><code class="language-code">  export class OcrResult {
    language: string;
    detectedText: string
  }

</code></pre>

<p>You can observe that both these classes have the same definition as the DTO classes we created on the server-side. This will allow us to bind the data returned from the server directly to our models.</p>

<h2 id="create-the-computer-vision-service">Create the Computer Vision Service</h2>

<p>We will create an Angular service which will invoke the Web API endpoints, convert the Web API response to JSON and pass it to our component. Run the following command.</p>

<pre><code class="language-code">
  ng g s services\Computervision

</code></pre>

<p>This command will create a folder name as services and then create the following two files inside it.</p>

<ul>
  <li><strong>computervision.service.ts</strong> — the service class file.</li>
  <li><strong>computervision.service.spec.ts</strong> — the unit test file for service.</li>
</ul>

<p>Open <span style="color:yellow;background-color:black;">computervision.service.ts</span> file and put the following code inside it.</p>

<pre><code class="language-code">  import { Injectable } from '@angular/core';
  import { HttpClient } from '@angular/common/http';
  @Injectable({
    providedIn: 'root'
  })
  export class ComputervisionService {
    baseURL: string;
    constructor(private http: HttpClient) {
      this.baseURL = '/api/OCR';
    }
    getAvailableLanguage() {
      return this.http.get(this.baseURL)
        .pipe(response =&gt; {
          return response;
        });
    }
    getTextFromImage(image: FormData) {
      return this.http.post(this.baseURL, image)
        .pipe(response =&gt; {
          return response;
        });
    }
  }

</code></pre>
<p>We have defined a variable baseURL which will hold the endpoint URL of our API. We will initialize the baseURL in the constructor and set it to the endpoint of the <span style="color:yellow;background-color:black;">OCRController</span>.</p>

<p>The <span style="color:yellow;background-color:black;">getAvailableLanguage</span> method will send a Get request to the <span style="color:yellow;background-color:black;">GetAvailableLanguages</span> method of the <span style="color:yellow;background-color:black;">OCRController</span> to fetch the list of supported languages for OCR.</p>

<p>The <span style="color:yellow;background-color:black;">getTextFromImage</span> method will send a Post request to the <span style="color:yellow;background-color:black;">OCRController</span> and supply the parameter of type <span style="color:yellow;background-color:black;">FormData</span>. It will fetch the detected text from the image and language code of the text.</p>

<h2 id="create-the-ocr-component">Create the Ocr component</h2>

<p>Run the following command in the command prompt to create the <span style="color:yellow;background-color:black;">OcrComponent</span>.</p>

<pre><code class="language-code">  
  ng g c ocr --module app

</code></pre>

<p>The –module flag will ensure that this component will get registered at <span style="color:yellow;background-color:black;">app.module.ts</span>.</p>

<p>Open <span style="color:yellow;background-color:black;">ocr.component.html</span> and put the following code in it.</p>

<pre><code class="language-code">    &lt;h2&gt;Optical Character Recognition (OCR) using Angular and Azure Computer Vision Cognitive Services&lt;/h2&gt;
  &lt;div class="row"&gt;
    &lt;div class="col-md-5"&gt;
      &lt;textarea disabled class="form-control" rows="10" cols="15"&gt;&lt;/textarea&gt;
      &lt;hr /&gt;
      &lt;div class="row"&gt;
        &lt;div class="col-sm-5"&gt;
          &lt;label&gt;&lt;strong&gt; Detected Language :&lt;/strong&gt;&lt;/label&gt;
        &lt;/div&gt;
        &lt;div class="col-sm-6"&gt;
          &lt;input disabled type="text" class="form-control" value= /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-5"&gt;
      &lt;div class="image-container"&gt;
        &lt;img class="preview-image" src=&gt;
      &lt;/div&gt;
      &lt;input type="file" (change)="uploadImage($event)" /&gt;
      &lt;p&gt;&lt;/p&gt;
      &lt;hr /&gt;
      &lt;button [disabled]="loading" class="btn btn-primary btn-lg" (click)="GetText()"&gt;
        &lt;span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"&gt;&lt;/span&gt;Extract Text
      &lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</code></pre>

<p>We have defined a text area to display the detected text and a text box for displaying the detected language. We have defined a file upload control which will allow us to upload an image. After uploading the image, the preview of the image will be displayed using an <span style="color:yellow;background-color:black;">img</span> element.</p>

<p>Open <span style="color:yellow;background-color:black;">ocr.component.ts</span> and put the following code in it.</p>

<pre><code class="language-code">  import { Component, OnInit } from '@angular/core';
import { ComputervisionService } from '../services/computervision.service';
import { AvailableLanguage } from '../models/availablelanguage';
import { OcrResult } from '../models/ocrresult';
@Component({
  selector: 'app-ocr',
  templateUrl: './ocr.component.html',
  styleUrls: ['./ocr.component.css']
})
export class OcrComponent implements OnInit {
  loading = false;
  imageFile;
  imagePreview;
  imageData = new FormData();
  availableLanguage: AvailableLanguage[];
  DetectedTextLanguage: string;
  ocrResult: OcrResult;
  DefaultStatus: string;
  status: string;
  maxFileSize: number;
  isValidFile = true;
  constructor(private computervisionService: ComputervisionService) {
    this.DefaultStatus = "Maximum size allowed for the image is 4 MB";
    this.status = this.DefaultStatus;
    this.maxFileSize = 4 * 1024 * 1024; // 4MB
  }
  ngOnInit() {
    this.computervisionService.getAvailableLanguage().subscribe(
      (result: AvailableLanguage[]) =&gt; this.availableLanguage = result
    );
  }
  uploadImage(event) {
    this.imageFile = event.target.files[0];
    if (this.imageFile.size &gt; this.maxFileSize) {
      this.status = `The file size is ${this.imageFile.size} bytes, this is more than the allowed limit of ${this.maxFileSize} bytes.`;
      this.isValidFile = false;
    } else if (this.imageFile.type.indexOf('image') == -1) {
      this.status = "Please upload a valid image file";
      this.isValidFile = false;
    } else {
      const reader = new FileReader();
      reader.readAsDataURL(event.target.files[0]);
      reader.onload = () =&gt; {
        this.imagePreview = reader.result;
      };
      this.status = this.DefaultStatus;
      this.isValidFile = true;
    }
  }
  GetText() {
    if (this.isValidFile) {
      this.loading = true;
      this.imageData.append('imageFile', this.imageFile);
      this.computervisionService.getTextFromImage(this.imageData).subscribe(
        (result: OcrResult) =&gt; {
          this.ocrResult = result;
          if (this.availableLanguage.find(x =&gt; x.languageID === this.ocrResult.language)) {
            this.DetectedTextLanguage = this.availableLanguage.find(x =&gt; x.languageID === this.ocrResult.language).languageName;
          } else {
            this.DetectedTextLanguage = "unknown";
          }
          this.loading = false;
        });
    }
  }
}
</code></pre>

<p>We will inject the <span style="color:yellow;background-color:black;">ComputervisionService</span> in the constructor of the <span style="color:yellow;background-color:black;">OcrComponent</span> and set a message and the value for the max image size allowed inside the constructor.</p>

<p>We will invoke the <span style="color:yellow;background-color:black;">getAvailableLanguage</span> method of our service in the <span style="color:yellow;background-color:black;">ngOnInit</span> and store the result in an array of type <span style="color:yellow;background-color:black;">AvailableLanguage<span>.</span></span></p>

<p>The <span style="color:yellow;background-color:black;">uploadImage</span> method will be invoked upon uploading an image. We will check if the uploaded file is a valid image and within the allowed size limit. We will process the image data using a <span style="color:yellow;background-color:black;">FileReader</span> object. The <span style="color:yellow;background-color:black;">readAsDataURL</span> method will read the contents of the uploaded file. Upon successful completion of the read operation, the <span style="color:yellow;background-color:black;">reader.onload</span> event will be triggered. The value of <span style="color:yellow;background-color:black;">imagePreview</span> will be set to the result returned by the fileReader object, which is of type <span style="color:yellow;background-color:black;">ArrayBuffer</span>.</p>

<p>Inside the <span style="color:yellow;background-color:black;">GetText</span> method, we will append the image file to a variable for type <span style="color:yellow;background-color:black;">FormData</span>. We will invoke the <span style="color:yellow;background-color:black;">getTextFromImage</span> of the service and bind the result to an object of type <span style="color:yellow;background-color:black;">OcrResult</span>. We will search for the language name from the array <span style="color:yellow;background-color:black;">availableLanguage</span>, based on the language code returned from the service. If the language code is not found, we will set the language as unknown.</p>

<p>We will add the styling for the text area in <span style="color:yellow;background-color:black;">ocr.component.css</span> as shown below.</p>

<pre><code class="language-code">
  .preview-image {
      max-height: 300px;
      max-width: 300px;
  }
  .image-container{
    display: flex;
    padding: 15px;
    align-content: center;
    align-items: center;
    justify-content: center;
    border: 2px dashed skyblue;
  }

</code></pre>

<h2 id="adding-the-links-in-nav-menu">Adding the links in Nav Menu</h2>

<p>We will add the navigation links for our components in the nav menu. Open <span style="color:yellow;background-color:black;">nav-menu.component.html</span> and remove the links for Counter and Fetch data components. Add the following lines in the list of navigation links.</p>

<pre><code class="language-code">  &lt;li class="nav-item" [routerLinkActive]="['link-active']"&gt;
    &lt;a class="nav-link text-dark" routerLink='/computer-vision-ocr'&gt;Computer Vision&lt;/a&gt;
  &lt;/li&gt;
</code></pre>

<h2 id="execution-demo">Execution Demo</h2>

<p>Press F5 to launch the application. Click on the Computer Vision button on the nav menu at the top. You can upload an image and extract the text from the image as shown in the image below.</p>

<p><img src="/img/azure/9/output.gif" alt="image info" /></p>

<h2 id="summary">Summary</h2>

<p>We have created an optical character recognition (OCR) application using Angular and the Computer Vision Azure Cognitive Service. The application is able to extract the printed text from the uploaded image and recognizes the language of the text. The OCR API of the Computer Vision is used which can recognize text in 25 languages.</p>

<p>Get the Source code from <a href="https://github.com/girishgodage/AngularComputerVisionAzureCognitiveServices">GitHub</a> and play around to get a better understanding.</p>

                </div>

                

                <div id="disqus_thread"></div>
                <script>
                
                /**
                *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');
                s.src = 'https://girishgodage-github-io.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



            </div>
        </div>
    </div>
    <!-- Go To Top-->
<button onclick="topFunction()"
id="myBtn"
title="Go to top"> <i class="fa fa-chevron-up"  style="font-size:36px"></i>
</button>
<!-- Footer-->
<footer class="main-footer">
    <div class="container">
        <div class="row">
            <div class="col-12 col-md-6 text-center text-lg-left">
                <p class="social">
                    <a href="https://www.facebook.com/girish.godage.5" class="external facebook wow fadeInUp">
                        <i class="fa fa-facebook"></i></a>
                    <a href="https://instagram.com/girishgodage_007" data-wow-delay="0.2s" class="external instagram wow fadeInUp">
                        <i class="fa fa-instagram"></i></a>
                    <a href="https://youtube.com/girishgodage" data-wow-delay="0.4s" class="external youtube wow fadeInUp">
                        <i class="fa fa-youtube-play"></i></a>
                    <a href="https://twitter.com/GGodage" data-wow-delay="0.4s" class="external twitter wow fadeInUp">
                            <i class="fa fa-twitter"></i></a>
                    <a href="https://github.com/girishgodage" data-wow-delay="0.4s" class="external github wow fadeInUp">
                                <i class="fa fa-github"></i></a>    
                    <a href="mailto:girishgodage@gmail.com?subject=Hello%20Girish" data-wow-delay="0.6s" class="email wow fadeInUp">
                        <i class="fa fa-envelope"></i></a></p>
            </div>
            <div class="col-12 col-md-2">
            <h5>Quick Links</h5>
            <ul>
               <li><a href="http://localhost:4000#about">About</a></li>
               <li><a href="http://localhost:4000#contact">Contact</a></li>
               <li><a href="http://localhost:4000/sitemap.xml">Sitemap</a></li>               
            </ul>
         </div>
            <div class="col-12 col-md-4 text-center text-lg-right mt-4 mt-lg-0">
                <p> <b>©</b><script>document.write(new Date().getFullYear())</script> Girish Godage </p>
                <p class="text-center, text-shadow"> Hosted On <a href="https://pages.github.com/">GitHub Pages</a></p>
            </div>
        </div>
    </div>
</footer>
    <!-- Typed.js DONT TOUCH THIS! -->
    <div id="typed-strings">
    </div>

        <!-- JavaScript files-->
    <script src="http://localhost:4000/sitejs/jquery/jquery.min.js"></script>
    <script src="http://localhost:4000/sitejs/popper.js/umd/popper.min.js"> </script>
    <script src="http://localhost:4000/sitejs/bootstrap/js/bootstrap.min.js"></script>
    <script src="http://localhost:4000/sitejs/jquery.cookie/jquery.cookie.js"> </script>
    <script src="http://localhost:4000/sitejs/owl.carousel/owl.carousel.min.js"></script>
    <script src="http://localhost:4000/sitejs/waypoints/lib/jquery.waypoints.min.js"></script>
    <script src="http://localhost:4000/sitejs/jquery.counterup/jquery.counterup.js"></script>
    <script src="http://localhost:4000/js/front.js"></script>
    <script src="http://localhost:4000/js/comment.js"></script>
       <!-- Script pointing to search-script.js -->
    <script src="http://localhost:4000/js/search-script.js" type="text/javascript"></script>
   
    <!-- Configuration -->
    <script>
         SimpleJekyllSearch({
         searchInput: document.getElementById('search-input'),
         resultsContainer: document.getElementById('results-container'),
         json: 'http://localhost:4000/search.json'
         })
         </script>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.2.0/firebase.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.2.0/firebase-analytics.js"></script>

<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyC36FUDDdOTidZJ8nzS5vfE7KVyayenKPE",
    authDomain: "githubcontactlist.firebaseapp.com",
    databaseURL: "https://githubcontactlist.firebaseio.com",
    projectId: "githubcontactlist",
    storageBucket: "githubcontactlist.appspot.com",
    messagingSenderId: "899685398702",
    appId: "1:899685398702:web:0c23c56d2d6d40df37553f",
    measurementId: "G-YWBRCYJYFW"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>
<script>
   $(function() {
      
    //make a variable to keep track of data coming from firebase
    var data = [];

    // Reference messages collection
      var messagesRef = firebase.database().ref('contactformmessages');  


    //listen to data updates from firebase
    messagesRef.on("value", function(snapshot) {
        console.log(snapshot.val());
        //when the data updates at firebase, put it in the data variable
        data = snapshot.val();
    })
    //Entire Contact Form (handler)
    $('#contactForm').submit(function(e) {
      e.preventDefault();

        var $form = $(this);
        console.log("Submit to Firebase");

        //disable submit button
        $form.find("#sendForm").prop('disabled', true);

        //get values to send to Firebase
        var name = $('#name').val();
        console.log(name);
		
		var surname = $('#surname').val();
        console.log(surname);
		
		var email = $('#email').val();
        console.log(email);	
		
		var phone = $('#phone').val();
        console.log(phone);

        var message = $('#message').val();
        console.log(message);

       
        //take the values from the form, and put them in an object
        var newContact = {
         "name": name,
			"surname": surname,
			"email": email,
			"phone": phone,
         "message": message
        }
        //put new object in data array
        data.push(newContact);
        console.log(data);

        //send the new data to Firebase
        messagesRef.set(data, function(err) {
            if (err) {
                alert("Data no go");
            }else{
            $("#form-wrapper").slideToggle();
            $('#form-success-message').slideToggle();
			}
        });

        return false;
    })
   
    
})
</script>

<script>

    function disableScrolling() {
        let x = window.scrollX;
        let y = window.scrollY;
        window.onscroll = function () { window.scrollTo(x, y); };
    }

    function enableScrolling() {
        window.onscroll = function () { };
    }

    // Add copy button
    let pres = document.getElementsByTagName('pre');
    Array.from(pres).forEach((element2) => {
        let element = document.createElement('button');
        element.setAttribute('class', 'btn btn-primary');
        element.innerHTML = 'Copy';
        element.style.float = 'right';

        element.addEventListener('click', (e) => {
            disableScrolling();
            console.log(e)
            let x = window.screenX;
            let y = window.screenY;

            element.innerHTML = 'copied';
            let tarea = document.createElement('textarea');
            tarea.innerHTML = element.parentElement.children[1].innerText;
            document.body.append(tarea);
            tarea.focus();
            tarea.select();
            document.execCommand('copy');
            tarea.style.display = 'none';
            setTimeout(() => {
                element.innerHTML = 'Copy';
            }, 2000);
            setTimeout(() => {
                enableScrolling();
            }, 0);
        })
        element2.insertBefore(element, element2.children[0]);
    })

    //Get the button
    myBtton = document.getElementById("myBtn");
    window.onscroll=function()
    {
        scrollFunction();
    }
    function scrollFunction(){
        if (document.body.scrollTop > 20 ||
        document.documentElement.scrollTop >20)
        {
            myBtton.style.display="block";           
        }else
        {
           myBtton.style.display="none";     
          
        }
    }
    //When user click on the top button
    function topFunction(){
      //  document.body.scrollTop =0;
      //  document.documentElement.scrollTop=0;
        $("html, body").animate({
            scrollTop: 0
        }, 600);
        return false;
    }

</script>

    
    


</body>

</html>