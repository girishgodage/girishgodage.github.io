---
title: 24. Zip File in Python
date: 2019-10-01 00:00:00 Z
categories:
- PythonTutorial
tags:
- learning
- Installation
image: https://girishgodage.github.io/img/Python_logo.png
author: Girish Godage
layout: posts
prevurl: https://girishgodage.github.io/blog/PythonRenameFile
nexturl: https://girishgodage.github.io/blog/PythonZipFile
discussion_id: 2019-10-01-PythonRenameFile
---

<section class="Ptutorial24">
    <div class="item-page" itemscope="" itemtype="https://schema.org/Article">
        <meta itemprop="inLanguage" content="en-GB">
        <div class="page-header">
            <h2 itemprop="headline"> Python ZIP file with Example </h2>
        </div>

        <div itemprop="articleBody">
            <p>Python allows you to quickly create zip/tar archives. </p>
            <p>Following command will zip entire directory </p>
            <pre class="code-toolbar">shutil.make_archive(output_filename, 'zip', dir_name)</pre>
            <p>Following command gives you control on the files you want to archive </p>
            <pre class="code-toolbar">ZipFile.write(filename)</pre>
            <p> Here are the steps to create Zip File in Python </p>
            <p><strong>Step 1)</strong> To create an archive file from Python, make sure you have your import statement
                correct and in order. Here the import statement for the archive is
                <code>from shutil import make_archive</code> </p>
            <p style="text-align: center; "><a
                    href="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.10.png"
                    class="jh-image-popup-colorbox cboxElement"><img
                        title="O.S Path Utilities &amp; File System Shell Methods Python"
                        alt="Python OS Module, Shell Script Commands"
                        src="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.10.png"></a> </p>
            <p><strong>Code Explanation</strong> </p>
            <ul>
                <li>Import make_archive class from module shutil</li>
                <li>Use the split function to split out the directory and the file name from the path to the location of
                    the text file (guru99)</li>
                <li>Then we call the module "shutil.make_archive("guru99 archive, "zip", root_dir)" to create archive
                    file, which will be in zip format</li>
                <li>After then we pass in the root directory of things we want to be zipped up. So everything in the
                    directory will be zipped </li>
                <li>When you run the code, you can see the archive zip file is created on the right side of the panel.
                </li>
            </ul>
            <p><strong>Step 2)</strong></p>
               <p> Once your archive file is made, you can right-click on the file and select the O.S, and it will show
                your archive files in it as shown below </p>
                <p style="text-align: center; "><a
                        href="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.11.png"
                        class="jh-image-popup-colorbox cboxElement"><img
                            title="O.S Path Utilities &amp; File System Shell Methods Python"
                            alt="Python OS Module, Shell Script Commands"
                            src="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.11.png"></a> </p>
                <p> Now your archive.zip file will appear on your O.S (Windows Explorer) </p>
                <p style="text-align: center; "><a
                        href="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.12.png"
                        class="jh-image-popup-colorbox cboxElement"><img
                            title="O.S Path Utilities &amp; File System Shell Methods Python"
                            alt="Python OS Module, Shell Script Commands"
                            src="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.12.png"></a> </p>
                <p><strong>Step 3)</strong> When you double-click on the file, you will see the list all the files in
                    there. </p>
                <p style="text-align: center;"><a
                        href="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.13.png"
                        class="jh-image-popup-colorbox cboxElement"><img
                            title="O.S Path Utilities &amp; File System Shell Methods Python"
                            alt="Python OS Module, Shell Script Commands"
                            src="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.13.png"></a> </p>

                <p><strong>Step 4)</strong> In Python we can have more control over archive since we can define which
                    specific file to include under archive. In our case, we will include two files under archive
                    <strong>"guru99.txt"</strong> and <strong>"guru99.txt.bak".</strong> </p>
                <p style="text-align: center; "><a
                        href="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.14.png"
                        class="jh-image-popup-colorbox cboxElement"><img
                            title="O.S Path Utilities &amp; File System Shell Methods Python"
                            alt="Python OS Module, Shell Script Commands"
                            src="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.14.png"></a> </p>
                <p><strong>Code Explanation</strong> </p>
                <ul>
                    <li>Import Zipfile class from zip file Python module. This module gives full control over creating
                        zip files</li>
                    <li>We create a new Zipfile with name ( "testguru99.zip, "w")</li>
                    <li>Creating a new Zipfile class, requires to pass in permission because it's a file, so you need to
                        write information into the file as newzip</li>
                    <li>We used variable "newzip" to refer to the zip file we created</li>
                    <li>Using the write function on the "newzip" variable, we add the files "guru99.txt" and
                        "guru99.txt.bak" to the archive</li>
                </ul>
                <p>When you execute the code you can see the file is created on the right side of the panel with name
                    "guru99.zip" </p>
                <p><strong>Note</strong>: Here we don't give any command to "close" the file like "newzip.close" because
                    we use "With" scope lock, so when program falls outside of this scope the file will be cleaned up
                    and is closed automatically. </p>
                <p><strong>Step 5)</strong> When you <strong>-&gt; right click on file (testguru99.zip) and -&gt; select
                        your O.S (Windows Explorer)</strong>, it will show the archive files in the folder as shown
                    below. </p>
                <p style="text-align: center; "><a
                        href="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.15.png"
                        class="jh-image-popup-colorbox cboxElement"><img
                            title="O.S Path Utilities &amp; File System Shell Methods Python"
                            alt="Python OS Module, Shell Script Commands"
                            src="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.15.png"></a> </p>
                <p>When you double click on file "testguru99.zip", it will open another window, and this will show the
                    files included in it. </p>
                <p style="text-align: center; "><a
                        href="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.16.png"
                        class="jh-image-popup-colorbox cboxElement"><img
                            title="O.S Path Utilities &amp; File System Shell Methods Python"
                            alt="Python OS Module, Shell Script Commands"
                            src="{{site.url}}{{site.baseurl}}/img/python/tutorial/24/Python18.16.png"></a> </p>
                <p>Here is the complete code </p>
                <p><b>Python 2 Example</b> </p>
                <pre class="code-toolbar">
         import os
         import shutil
         from zipfile import ZipFile
         from os import path
         from shutil import make_archive
         
         def main():
         # Check if file exists
             if path.exists("guru99.txt"):
         # get the path to the file in the current directory
             src = path.realpath("guru99.txt");
         # rename the original file
             os.rename("career.guru99.txt","guru99.txt")
         # now put things into a ZIP archive
             root_dir,tail = path.split(src)
             shutil.make_archive("guru99 archive", "zip", root_dir)
         # more fine-grained control over ZIP files
             with ZipFile("testguru99.zip","w") as newzip:
             newzip.write("guru99.txt")
                 newzip.write("guru99.txt.bak")
         if __name__== "__main__":
               main()</pre>
                <p><b>Python 3 Example</b> </p>
                <pre class="code-toolbar">import os
         import shutil
         from zipfile import ZipFile
         from os import path
         from shutil import make_archive
         
             # Check if file exists
                if path.exists("guru99.txt"):
             # get the path to the file in the current directory
                 src = path.realpath("guru99.txt");
             # rename the original file
                 os.rename("career.guru99.txt","guru99.txt")
             # now put things into a ZIP archive
                 root_dir,tail = path.split(src)
                 shutil.make_archive("guru99 archive","zip",root_dir)
             # more fine-grained control over ZIP files
                 with ZipFile("testguru99.zip", "w") as newzip:
                     newzip.write("guru99.txt")
                     newzip.write("guru99.txt.bak")</pre>
                <p><strong>Summary</strong> </p>
                <ul>
                    <li>To zip entire directory use command "shutil.make_archive("name","zip", root_dir)</li>
                    <li>To select the files to zip use command "ZipFile.write(filename)"</li>
                </ul>

            </li>
        </div>

    </div>
</section>
{% include blogslide.html %}